<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baronesa Confeitaria Artesanal | Pedido Online</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: 'Poppins', sans-serif; }
        .modal-enter { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        /* Scrollbar personalizada */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #db2777; border-radius: 10px; }
    </style>
    
    <script>
        tailwind.config = {
            theme: { extend: { colors: { primary: '#db2777', 'primary-dark': '#be185d' } } }
        }
    </script>
</head>
<body class="bg-gray-50 pb-20">

    <header class="bg-pink-100 shadow-sm fixed top-0 w-full z-40">
        <div class="container mx-auto px-4 py-2 flex justify-between items-center">
            
            <div class="flex items-center">
                <img src="img/logo.png" alt="Logo Baronesa" class="h-14 w-auto object-contain mix-blend-multiply">
            </div>

            <div id="storeStatus" class="bg-white px-4 py-1 rounded-full text-xs font-bold shadow-sm border border-pink-100"></div>
        </div>
    </header>

    <button onclick="openCart()" class="fixed bottom-6 right-6 bg-green-600 text-white w-16 h-16 rounded-full shadow-2xl z-50 flex items-center justify-center hover:scale-110 transition-transform">
        <i class="fas fa-shopping-cart text-xl"></i>
        <span id="cartCount" class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold w-6 h-6 rounded-full flex items-center justify-center hidden border-2 border-white">0</span>
    </button>

    <section class="mt-16 h-64 bg-cover bg-center relative flex items-center justify-center" style="background-image: url('img/bolo.png');">
        
        <div class="absolute inset-0 bg-black/30"></div>
        
        <div class="relative text-center text-white px-4 flex flex-col items-center">
            
            <img src="img/logo2.png" alt="Baronesa" class="h-32 w-auto object-contain mb-2">
            
            <p class="text-gray-100 text-lg italic font-medium drop-shadow-sm">"Transformando amor em doces!"</p>
            
            <a href="#menuContainer" class="mt-4 bg-primary hover:bg-primary-dark text-white text-sm font-bold py-2 px-6 rounded-full shadow-lg transition-transform hover:scale-105">
                Ver Card√°pio
            </a>
        </div>
    </section>

    <main class="container mx-auto px-4 py-8 max-w-4xl" id="menuContainer">
        </main>
        <footer class="bg-white border-t-4 border-pink-100 mt-12 pt-10 pb-28">
        <div class="container mx-auto px-4 text-center">
            
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-primary font-[Poppins]">Baronesa</h3>
                <p class="text-gray-500 text-sm mt-1">Confeitaria Artesanal</p>
                <div class="mt-3 inline-block bg-pink-50 px-4 py-1 rounded-full border border-pink-100">
                    <p class="text-sm text-gray-600">Por: <span class="font-bold text-primary-dark">Renata Baron</span> <i class="fas fa-heart text-xs text-red-400 ml-1"></i></p>
                </div>
            </div>

            <div class="space-y-3 text-sm text-gray-600 mb-8">
                <p class="flex items-center justify-center gap-2">
                    <i class="fas fa-map-marker-alt text-primary text-lg"></i>
                    <span>Rua S√£o Jo√£o, 1015 - Tingui<br>Curitiba - PR</span>
                </p>
                
                <a href="https://wa.me/5541998747724" target="_blank" class="flex items-center justify-center gap-2 hover:text-green-600 transition-colors font-medium">
                    <i class="fab fa-whatsapp text-xl text-green-500"></i>
                    <span>(41) 99874-7724</span>
                </a>

                <a href="https://instagram.com" target="_blank" class="flex items-center justify-center gap-2 hover:text-pink-600 transition-colors font-medium">
                    <i class="fab fa-instagram text-xl text-pink-500"></i>
                    <span>@baronesa.confeitaria.artesanal</span>
                </a>
            </div>

            <div class="border-t border-gray-100 pt-6 text-xs text-gray-400">
                <p>&copy; 2026 Baronesa Confeitaria. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <div id="flavorModal" class="fixed inset-0 bg-black/60 z-[60] hidden items-center justify-center p-4 modal-enter">
        <div class="bg-white rounded-xl w-full max-w-md max-h-[90vh] flex flex-col overflow-hidden shadow-2xl">
            <div class="bg-primary text-white p-4">
                <h3 class="font-bold text-lg" id="flavorModalTitle">Escolha os Sabores</h3>
                <p class="text-xs text-pink-100" id="flavorModalSubtitle">Selecione as op√ß√µes</p>
            </div>
            
            <div class="p-4 overflow-y-auto custom-scroll" id="flavorListContainer">
                </div>

            <div class="p-4 border-t bg-gray-50 flex justify-end gap-3">
                <button onclick="closeFlavorModal()" class="px-4 py-2 text-gray-600 font-medium text-sm">Cancelar</button>
                <button onclick="confirmFlavorSelection()" class="bg-primary text-white px-6 py-2 rounded-lg font-bold hover:bg-primary-dark text-sm">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="cartModal" class="fixed inset-0 bg-black/60 z-[60] hidden items-end sm:items-center justify-center modal-enter">
        <div class="bg-white w-full sm:max-w-lg sm:rounded-2xl h-[90vh] sm:h-auto flex flex-col shadow-2xl">
            <div class="bg-white border-b p-4 flex justify-between items-center rounded-t-2xl">
                <h3 class="font-bold text-lg flex items-center gap-2"><i class="fas fa-shopping-bag text-primary"></i> Seu Pedido</h3>
                <button onclick="closeCart()" class="text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 bg-gray-50 custom-scroll">
                <div class="bg-yellow-50 border border-yellow-200 p-3 rounded-lg text-xs text-yellow-800 mb-4 flex gap-2">
                    <i class="fas fa-clock mt-1"></i>
                    <div>
                        <strong>Prazos de Produ√ß√£o:</strong><br>
                        Doces: M√≠nimo 1 dia √∫til.<br>
                        Bolos: M√≠nimo 3 dias √∫teis.<br>
                        <span class="italic">Para pronta entrega, consulte no WhatsApp.</span>
                    </div>
                </div>

                <div id="cartItems" class="space-y-3"></div>
                
                <div id="emptyCart" class="text-center py-10 text-gray-400 hidden">
                    <i class="fas fa-basket-shopping text-4xl mb-2"></i>
                    <p>Carrinho vazio</p>
                </div>

                <div id="checkoutForm" class="mt-6 border-t pt-4 hidden">
                    <h4 class="font-bold text-gray-700 mb-3 text-sm uppercase"><i class="far fa-user mr-1"></i> Seus Dados</h4>
                    <div class="space-y-3">
                        <input type="text" id="custName" placeholder="Seu Nome Completo *" class="w-full p-3 border rounded-lg text-sm outline-none focus:border-primary">
                        
                        <div class="grid grid-cols-2 gap-3">
                            <label class="border p-3 rounded-lg flex items-center justify-center gap-2 cursor-pointer has-[:checked]:bg-pink-50 has-[:checked]:border-primary transition-all">
                                <input type="radio" name="delType" value="retirada" checked onchange="toggleAddr()" class="accent-primary">
                                <span class="text-sm font-medium">Retirada</span>
                            </label>
                            <label class="border p-3 rounded-lg flex items-center justify-center gap-2 cursor-pointer has-[:checked]:bg-pink-50 has-[:checked]:border-primary transition-all">
                                <input type="radio" name="delType" value="entrega" onchange="toggleAddr()" class="accent-primary">
                                <span class="text-sm font-medium">Entrega</span>
                            </label>
                        </div>
                        <p id="pickupInfo" class="text-xs text-center text-gray-500 bg-gray-100 p-2 rounded">üìç Retirada: Rua S√£o Jo√£o, 1015 - Tingui</p>
                        
                        <input type="text" id="custAddr" placeholder="Endere√ßo Completo (Rua, N√∫mero, Bairro) *" class="w-full p-3 border rounded-lg text-sm hidden outline-none focus:border-primary">
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="text-xs font-bold text-gray-500 ml-1">Data/Hora *</label>
                                <input type="datetime-local" id="delTime" class="w-full p-2 border rounded-lg text-sm text-gray-600 outline-none focus:border-primary">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 ml-1">Pagamento *</label>
                                <select id="payMethod" class="w-full p-2 border rounded-lg text-sm bg-white outline-none focus:border-primary">
                                    <option value="" disabled selected>Selecione...</option>
                                    <option value="Pix">Pix</option>
                                    <option value="Cart√£o Cr√©dito">Cart√£o Cr√©dito</option>
                                    <option value="Cart√£o D√©bito">Cart√£o D√©bito</option>
                                    <option value="Dinheiro">Dinheiro</option>
                                </select>
                            </div>
                        </div>

                        <textarea id="custObs" rows="2" placeholder="Observa√ß√µes extras..." class="w-full p-3 border rounded-lg text-sm outline-none focus:border-primary resize-none"></textarea>
                    </div>
                </div>
            </div>

            <div id="cartFooter" class="p-4 border-t bg-white hidden">
                <div class="flex justify-between items-center mb-3">
                    <span class="text-sm text-gray-500">Total Estimado:</span>
                    <span id="cartTotal" class="text-2xl font-bold text-primary">R$ 0,00</span>
                </div>
                <button onclick="finalizeOrder()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg flex items-center justify-center gap-2 shadow-lg transition-transform active:scale-95">
                    <i class="fab fa-whatsapp text-xl"></i> Enviar Pedido no WhatsApp
                </button>
            </div>
        </div>
    </div>

    <script>
        // === 1. LISTAS DE SABORES (AGORA COM FOTO E DESCRI√á√ÉO) ===
        // Transcrito das imagens do card√°pio oficial
        const flavorsDB = {
            classicos: [
                { name: "Brigadeiro Preto", desc: "Cacau 33%, granulado vermicelli Melken.", img: "https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=150" },
                { name: "Brigadeiro Branco", desc: "Leite condensado e creme de leite, granulado branco.", img: "https://images.unsplash.com/photo-1599347335071-7f413a967523?w=150" },
                { name: "Dois Amores", desc: "Brigadeiro branco e preto, a√ß√∫car uni√£o premium.", img: "img/doisamores.png" },
                { name: "Pa√ßoquinha", desc: "Feito com pa√ßoca e enrolado na pa√ßoca mo√≠da.", img: "https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=150" },
                { name: "Chocoball", desc: "Cacau 50% e cereal Choco Power Ball.", img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=150" },
                { name: "Bicho de P√©", desc: "Feito com Nesquik e enrolado no Leite Ninho.", img: "https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=150" },
                { name: "Beijinho", desc: "Coco em flocos, coco √∫mido e ado√ßado.", img: "https://images.unsplash.com/photo-1599785209707-a456fc1337bb?w=150" },
                { name: "Prest√≠gio", desc: "Cacau 50%, coco flocos √∫mido e ado√ßado.", img: "https://images.unsplash.com/photo-1628606825227-3132646c0780?w=150" },
                { name: "Cajuzinho", desc: "Castanha de caju, a√ß√∫car premium e amendoim.", img: "https://images.unsplash.com/photo-1579372786545-d24232daf58c?w=150" },
                { name: "Olho de Sogra", desc: "Coco, ess√™ncia de baunilha e ameixa seca.", img: "https://images.unsplash.com/photo-1582650077873-1cb8dc667232?w=150" }
            ],
            gourmet: [
                { name: "Gourmet Preto", desc: "Cacau 50%, granulado Granul√™ Melken.", img: "https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=150" },
                { name: "Meio Amargo", desc: "Cacau 100%, granulado Granul√™ Melken.", img: "https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=150" },
                { name: "Gourmet Prest√≠gio", desc: "Massa de coco, Granul√™ Melken e coco.", img: "https://images.unsplash.com/photo-1599347335071-7f413a967523?w=150" },
                { name: "Gourmet Branco", desc: "Chocolate branco, Granul√™ Melken Branco.", img: "https://images.unsplash.com/photo-1599785209796-786432b228bc?w=150" },
                { name: "Churros", desc: "Doce de leite, canela e a√ß√∫car.", img: "https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=150" },
                { name: "Coco Queimado", desc: "Feito com coco queimado artesanal.", img: "https://images.unsplash.com/photo-1582650077873-1cb8dc667232?w=150" },
                { name: "Leite Ninho", desc: "Leite Ninho puro (sem Nutella).", img: "https://images.unsplash.com/photo-1599785209707-a456fc1337bb?w=150" },
                { name: "Confete", desc: "Cacau 50% e granulado colorido.", img: "https://images.unsplash.com/photo-1579372786545-d24232daf58c?w=150" }
            ],
            especiais: [
                { name: "Ninho c/ Nutella", desc: "Massa Ninho, finaliza√ß√£o Nutella Pura.", img: "https://images.unsplash.com/photo-1606313564200-e75d5e30476d?w=150" },
                { name: "Rafaello", desc: "Massa beijinho, am√™ndoa inteira, ganache branca.", img: "https://images.unsplash.com/photo-1599785209707-a456fc1337bb?w=150" },
                { name: "Ferrero Rocher", desc: "Gourmet 50%, avel√£ inteira, amendoim e Nutella.", img: "https://images.unsplash.com/photo-1628606825227-3132646c0780?w=150" },
                { name: "Strogonoff Nozes", desc: "Peda√ßos de nozes, doce de leite e Ninho.", img: "https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=150" },
                { name: "Surpresa Uva", desc: "Massa Ninho verde, uva verde sem semente.", img: "https://images.unsplash.com/photo-1599347335071-7f413a967523?w=150" },
                { name: "Creme Brulle", desc: "Gemas, baunilha e a√ß√∫car ma√ßaricado.", img: "https://images.unsplash.com/photo-1589119908995-c6837fa14848?w=150" }
            ],
            luxo: [
                { name: "Kinder Bueno", desc: "Massa Ninho/50%, Nutella e Kinder.", img: "https://images.unsplash.com/photo-1589119908995-c6837fa14848?w=150" },
                { name: "Sensa√ß√£o", desc: "Gourmet 50%, Blossoms morango Callebaut.", img: "https://images.unsplash.com/photo-1628606825227-3132646c0780?w=150" },
                { name: "Caf√©", desc: "Creme de caf√© e cacau 100%.", img: "https://images.unsplash.com/photo-1579372786545-d24232daf58c?w=150" },
                { name: "Brigadeiro Belga", desc: "Chocolate belga, Flakes ao leite Callebaut.", img: "https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=150" },
                { name: "Maracuj√°", desc: "Maracuj√° fruta, Ninho e ganache branca.", img: "https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=150" }
            ],
            finos: [
                { name: "Pistache", desc: "Creme de pistache e sementes.", img: "https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=150" },
                { name: "Camafeu Nozes", desc: "Brigadeiro nozes, fondant e noz dourada.", img: "https://images.unsplash.com/photo-1599347335071-7f413a967523?w=150" },
                { name: "Frutas Vermelhas", desc: "Creme frutas vermelhas e Crispearls Ruby.", img: "https://images.unsplash.com/photo-1628606825227-3132646c0780?w=150" }
            ],
            // Para Brownies e Bombons (Sem descri√ß√£o detalhada necess√°ria, apenas op√ß√µes)
            recheios_brownie: [
                { name: "Sem Recheio", desc: "Tradicional", img: "https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=150" },
                { name: "Nutella", desc: "Recheio cremoso", img: "https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=150" },
                { name: "Doce de Leite", desc: "Recheio caseiro", img: "https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=150" }
            ],
            cobertura_bombom: [
                { name: "Ao Leite", desc: "Chocolate Nobre", img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=150" },
                { name: "Meio Amargo", desc: "Chocolate Nobre", img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=150" },
                { name: "Blend", desc: "Mistura Leite/Amargo", img: "https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=150" }
            ]
        };

        // === 2. CARD√ÅPIO COMPLETO ===
        const menuItems = [
            // CAIXAS PRESENTE
            { id: 101, cat: 'üéÅ Caixas Presente', name: 'Caixa P (15 Doces)', desc: 'Cl√°ssicos e Gourmet.', price: 32.90, maxFlavors: 3, allowedFlavors: ['classicos', 'gourmet'], img: 'https://images.unsplash.com/photo-1599785209796-786432b228bc?w=400' },
            { id: 102, cat: 'üéÅ Caixas Presente', name: 'Caixa M (30 Doces)', desc: 'Cl√°ssicos e Gourmet.', price: 59.90, maxFlavors: 4, allowedFlavors: ['classicos', 'gourmet'], img: 'https://images.unsplash.com/photo-1582650077873-1cb8dc667232?w=400' },
            { id: 103, cat: 'üéÅ Caixas Presente', name: 'Caixa G (49 Doces)', desc: 'Cl√°ssicos e Gourmet.', price: 109.90, maxFlavors: 5, allowedFlavors: ['classicos', 'gourmet'], img: 'https://images.unsplash.com/photo-1579372786545-d24232daf58c?w=400' },
            { id: 105, cat: 'üéÅ Caixas Premium', name: 'Caixa Premium P (15un)', desc: 'Especiais e Luxo.', price: 42.90, maxFlavors: 3, allowedFlavors: ['especiais', 'luxo'], img: 'https://images.unsplash.com/photo-1606313564200-e75d5e30476d?w=400' },
            { id: 106, cat: 'üéÅ Caixas Premium', name: 'Caixa Premium M (30un)', desc: 'Especiais e Luxo.', price: 79.90, maxFlavors: 4, allowedFlavors: ['especiais', 'luxo'], img: 'https://images.unsplash.com/photo-1589119908995-c6837fa14848?w=400' },

            // UNIDADES
            { id: 301, cat: 'üç´ Unidades', name: 'Mini Brownie Trad.', price: 4.00, desc: 'Sem recheio', img: 'https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=400' },
            { id: 302, cat: 'üç´ Unidades', name: 'Mini Brownie Recheado', price: 5.00, maxFlavors: 1, allowedFlavors: ['recheios_brownie'], img: 'https://images.unsplash.com/photo-1614597396930-a69e078882d8?w=400' },
            { id: 303, cat: 'üç´ Unidades', name: 'Bombom de Morango', price: 7.90, maxFlavors: 1, allowedFlavors: ['cobertura_bombom'], img: 'https://images.unsplash.com/photo-1600093463592-8e36ae95ef56?w=400' },

            // KITS FESTA 25 UN
            { id: 410, cat: 'üéâ Festa (Kit 25un)', name: 'Kit 25 Cl√°ssicos', price: 50.00, maxFlavors: 4, allowedFlavors: ['classicos'], img: 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400' },
            { id: 411, cat: 'üéâ Festa (Kit 25un)', name: 'Kit 25 Gourmet', price: 55.00, maxFlavors: 4, allowedFlavors: ['gourmet'], img: 'https://images.unsplash.com/photo-1599347335071-7f413a967523?w=400' },
            { id: 412, cat: 'üéâ Festa (Kit 25un)', name: 'Kit 25 Especiais', price: 62.50, maxFlavors: 4, allowedFlavors: ['especiais'], img: 'https://images.unsplash.com/photo-1628606825227-3132646c0780?w=400' },
            { id: 413, cat: 'üéâ Festa (Kit 25un)', name: 'Kit 25 Luxo', price: 70.00, maxFlavors: 4, allowedFlavors: ['luxo'], img: 'https://images.unsplash.com/photo-1589119908995-c6837fa14848?w=400' },

            // CENTOS 100 UN
            { id: 401, cat: 'üì¶ Centos (100un)', name: 'Cento Cl√°ssicos', price: 200.00, maxFlavors: 5, allowedFlavors: ['classicos'], img: 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400' },
            { id: 402, cat: 'üì¶ Centos (100un)', name: 'Cento Gourmet', price: 220.00, maxFlavors: 5, allowedFlavors: ['gourmet'], img: 'https://images.unsplash.com/photo-1599347335071-7f413a967523?w=400' },
            { id: 403, cat: 'üì¶ Centos (100un)', name: 'Cento Especiais', price: 250.00, maxFlavors: 5, allowedFlavors: ['especiais'], img: 'https://images.unsplash.com/photo-1628606825227-3132646c0780?w=400' },
            { id: 404, cat: 'üì¶ Centos (100un)', name: 'Cento Luxo', price: 280.00, maxFlavors: 5, allowedFlavors: ['luxo'], img: 'https://images.unsplash.com/photo-1589119908995-c6837fa14848?w=400' }
        ];

        let cart = [];
        let currentItemToAdd = null;

        window.onload = () => { renderMenu(); checkStatus(); setMinTime(); };

        // === RENDERIZA√á√ÉO DO MENU ===
        function renderMenu() {
            const container = document.getElementById('menuContainer');
            const categories = [...new Set(menuItems.map(i => i.cat))];
            
            let html = '';
            categories.forEach(cat => {
                const items = menuItems.filter(i => i.cat === cat);
                html += `
                    <div class="mb-8">
                        <h4 class="text-lg font-bold text-gray-800 mb-4 border-l-4 border-primary pl-3">${cat}</h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            ${items.map(item => `
                                <div class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex gap-3 hover:shadow-md transition">
                                    <img src="${item.img}" class="w-24 h-24 object-cover rounded-full bg-gray-200 shadow-sm">
                                    
                                    <div class="flex-1 flex flex-col justify-between">
                                        <div>
                                            <h5 class="font-bold text-gray-800 leading-tight">${item.name}</h5>
                                            <p class="text-xs text-gray-500 mt-1">${item.desc || (item.maxFlavors ? `Escolha at√© ${item.maxFlavors} sabores` : '')}</p>
                                        </div>
                                        <div class="flex justify-between items-end mt-2">
                                            <span class="font-bold text-primary">R$ ${item.price.toFixed(2)}</span>
                                            <button onclick="initAddToCart(${item.id})" class="bg-pink-100 text-primary hover:bg-primary hover:text-white px-3 py-1 rounded-full text-xs font-bold transition-colors">
                                                Adicionar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // === L√ìGICA DE SABORES (MODAL ATUALIZADO COM FOTOS) ===
        function initAddToCart(id) {
            const item = menuItems.find(i => i.id === id);
            if (!item.allowedFlavors) { addToCart(item, []); return; }
            currentItemToAdd = item;
            openFlavorModal(item);
        }

        // === L√ìGICA DE SABORES (COM FOTOS REDONDAS) ===
        // === L√ìGICA DE SABORES (COM FOTOS E TEXTOS MAIORES) ===
        function openFlavorModal(item) {
            const modal = document.getElementById('flavorModal');
            document.getElementById('flavorModalTitle').innerText = item.name;
            document.getElementById('flavorModalSubtitle').innerText = `Selecione at√© ${item.maxFlavors} sabores.`;
            
            let html = '';
            
            item.allowedFlavors.forEach(key => {
                // T√≠tulo da Categoria
                if(item.allowedFlavors.length > 1) {
                    html += `<h5 class="font-bold text-base text-primary mt-4 mb-2 uppercase tracking-wide border-b border-pink-100 pb-1 sticky top-0 bg-white z-10">${key.toUpperCase().replace('_', ' ')}</h5>`;
                }

                // LISTA DE ITENS (AUMENTADA)
                flavorsDB[key].forEach(flavor => {
                    html += `
                    <label class="flex items-center p-4 rounded-xl hover:bg-pink-50 cursor-pointer border-b border-gray-100 gap-4 transition-colors">
                        <img src="${flavor.img}" class="w-20 h-20 rounded-full object-cover bg-gray-200 flex-shrink-0 border-2 border-white shadow-md">
                        
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-base font-bold text-gray-800 leading-tight">${flavor.name}</span>
                                
                                <input type="checkbox" value="${flavor.name}" class="flavor-checkbox accent-primary w-6 h-6 rounded ml-3" onchange="checkMaxFlavors()">
                            </div>
                            <p class="text-sm text-gray-500 leading-snug">${flavor.desc}</p>
                        </div>
                    </label>`;
                });
            });

            document.getElementById('flavorListContainer').innerHTML = html;
            modal.classList.remove('hidden'); modal.classList.add('flex');
        }

        function checkMaxFlavors() {
            const max = currentItemToAdd.maxFlavors;
            const checked = document.querySelectorAll('.flavor-checkbox:checked');
            if (checked.length > max) {
                event.target.checked = false;
                alert(`M√°ximo de ${max} sabores permitidos para este item.`);
            }
        }

        function confirmFlavorSelection() {
            const checked = document.querySelectorAll('.flavor-checkbox:checked');
            if (checked.length === 0) return alert("Selecione pelo menos 1 sabor.");
            const selected = Array.from(checked).map(cb => cb.value);
            addToCart(currentItemToAdd, selected);
            closeFlavorModal();
        }

        function closeFlavorModal() {
            document.getElementById('flavorModal').classList.add('hidden');
            document.getElementById('flavorModal').classList.remove('flex');
            currentItemToAdd = null;
        }

        // === CARRINHO ===
        function addToCart(item, flavors) {
            const uniqueId = item.id + '-' + flavors.sort().join('|');
            const existing = cart.find(i => i.uniqueId === uniqueId);
            if (existing) existing.qty++;
            else cart.push({ uniqueId, ...item, flavors, qty: 1 });
            updateCartUI();
            
            // Toast Notification
            const btn = event.target.closest('button');
            if(btn) {
                const originalText = btn.innerText;
                btn.innerText = "Adicionado!";
                btn.classList.add("bg-green-500", "text-white");
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove("bg-green-500", "text-white");
                }, 1000);
            }
        }

        function updateCartUI() {
            const totalQty = cart.reduce((acc, i) => acc + i.qty, 0);
            const totalVal = cart.reduce((acc, i) => acc + (i.price * i.qty), 0);
            
            document.getElementById('cartCount').innerText = totalQty;
            document.getElementById('cartCount').classList.toggle('hidden', totalQty === 0);
            document.getElementById('cartTotal').innerText = `R$ ${totalVal.toFixed(2)}`;
            
            const container = document.getElementById('cartItems');
            if (cart.length === 0) {
                document.getElementById('emptyCart').classList.remove('hidden');
                document.getElementById('checkoutForm').classList.add('hidden');
                document.getElementById('cartFooter').classList.add('hidden');
                container.innerHTML = '';
            } else {
                document.getElementById('emptyCart').classList.add('hidden');
                document.getElementById('checkoutForm').classList.remove('hidden');
                document.getElementById('cartFooter').classList.remove('hidden');
                
                container.innerHTML = cart.map(item => `
                    <div class="bg-white border p-3 rounded-lg shadow-sm">
                        <div class="flex justify-between items-start">
                            <div>
                                <h5 class="font-bold text-sm text-gray-800">${item.name}</h5>
                                ${item.flavors.length ? `<p class="text-xs text-gray-500 mt-1 line-clamp-2">Sabores: ${item.flavors.join(', ')}</p>` : ''}
                            </div>
                            <span class="font-bold text-primary text-sm whitespace-nowrap ml-2">R$ ${(item.price * item.qty).toFixed(2)}</span>
                        </div>
                        
                        <div class="flex justify-between items-center mt-3">
                            <button onclick="removeItem('${item.uniqueId}')" class="text-red-400 text-xs hover:text-red-600 font-medium flex items-center"><i class="fas fa-trash mr-1"></i> Remover</button>
                            <div class="flex items-center bg-gray-100 rounded-lg">
                                <button onclick="changeQty('${item.uniqueId}', -1)" class="px-3 py-1 text-gray-600 font-bold hover:bg-gray-200 rounded-l-lg">-</button>
                                <span class="text-xs font-bold px-2 min-w-[20px] text-center">${item.qty}</span>
                                <button onclick="changeQty('${item.uniqueId}', 1)" class="px-3 py-1 text-gray-600 font-bold hover:bg-gray-200 rounded-r-lg">+</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function changeQty(uid, delta) {
            const item = cart.find(i => i.uniqueId === uid);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) removeItem(uid);
                else updateCartUI();
            }
        }

        function removeItem(uid) { cart = cart.filter(i => i.uniqueId !== uid); updateCartUI(); }

        // === UTILIT√ÅRIOS ===
        function openCart() { document.getElementById('cartModal').classList.remove('hidden'); document.getElementById('cartModal').classList.add('flex'); }
        function closeCart() { document.getElementById('cartModal').classList.add('hidden'); document.getElementById('cartModal').classList.remove('flex'); }
        function toggleAddr() {
            const isDel = document.querySelector('input[name="delType"]:checked').value === 'entrega';
            document.getElementById('custAddr').classList.toggle('hidden', !isDel);
            document.getElementById('pickupInfo').classList.toggle('hidden', isDel);
        }
        function checkStatus() {
            const now = new Date(); const d = now.getDay(); const h = now.getHours();
            const isOpen = (d === 0 && h >= 10 && h < 12) || (d >= 2 && d <= 6 && h >= 10 && h < 19);
            document.getElementById('storeStatus').innerHTML = isOpen ? '<span class="text-green-600">‚óè Aberto</span>' : '<span class="text-red-500">‚óè Fechado</span>';
        }
        function setMinTime() {
            const now = new Date(); now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('delTime').min = now.toISOString().slice(0, 16);
        }

        // === FINALIZAR ===
        function finalizeOrder() {
            const name = document.getElementById('custName').value;
            const type = document.querySelector('input[name="delType"]:checked').value;
            const addr = document.getElementById('custAddr').value;
            const time = document.getElementById('delTime').value;
            const pay = document.getElementById('payMethod').value;
            const obs = document.getElementById('custObs').value;

            if (!name || !time || !pay || (type === 'entrega' && !addr)) return alert('Preencha os campos obrigat√≥rios (*)');

            let msg = `Ol√° Baronesa! Novo pedido via Site:\n\n`;
            cart.forEach(i => {
                msg += `${i.qty}x ${i.name}\n`;
                if(i.flavors.length) msg += `   ‚îî Sabores: ${i.flavors.join(', ')}\n`;
                msg += `   (R$ ${(i.price * i.qty).toFixed(2)})\n\n`;
            });
            const total = cart.reduce((acc, i) => acc + (i.price * i.qty), 0);
            msg += `*Total: R$ ${total.toFixed(2)}*\n--------------------------\n`;
            msg += `Cliente: ${name}\nTipo: ${type.toUpperCase()}\n`;
            if (type === 'entrega') msg += `Endere√ßo: ${addr}\n`;
            const dateObj = new Date(time);
            msg += `Data: ${dateObj.toLocaleDateString()} √†s ${dateObj.toLocaleTimeString().slice(0,5)}\n`;
            msg += `Pagamento: ${pay}\n`;
            if (obs) msg += `Obs: ${obs}`;

            const phone = '5541998747724'; 
            window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        }
    </script>
</body>
</html>